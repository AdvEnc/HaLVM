#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1
VERSION:=@PACKAGE_VERSION@
ARCH:=@ARCHITECTURE@


%:
	dh $@

override_dh_auto_clean:
	echo "skip dh_auto_clean"

override_dh_shlibdeps:
	dh_shlibdeps -l/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/lib

override_dh_strip:
	dh_strip
	chrpath -d debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/alex
	chrpath -d debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/cabal
	chrpath -d debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/ghc
	chrpath -d debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/ghc-pkg
	chrpath -d debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/haddock
	chrpath -d debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/happy
	chrpath -d debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/HsColour
	chrpath -r /usr/lib/$(ARCH)-linux/gnu/HaLVM-$(VERSION)/bin \
	             debian/halvm-$(VERSION)/usr/lib/$(ARCH)-linux-gnu/HaLVM-$(VERSION)/bin/hsc2hs.bin
	mv debian/halvm-$(VERSION)/usr/share/doc/ghc debian/halvm-$(VERSION)/usr/share/doc/HaLVM-ghc
	mkdir -p debian/halvm-$(VERSION)/usr/share/HaLVM-$(VERSION)
	cp -r examples debian/halvm-$(VERSION)/usr/share/HaLVM-$(VERSION)/
